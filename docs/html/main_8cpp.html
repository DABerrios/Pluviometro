<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Pluviometro: src/main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Pluviometro
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('main_8cpp.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">main.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;Arduino.h&gt;</code><br />
<code>#include &lt;SPI.h&gt;</code><br />
<code>#include &lt;Wire.h&gt;</code><br />
<code>#include &lt;RTClib.h&gt;</code><br />
<code>#include &lt;esp_sleep.h&gt;</code><br />
<code>#include &lt;AsyncTCP.h&gt;</code><br />
<code>#include &lt;ESPAsyncWebServer.h&gt;</code><br />
<code>#include &lt;WiFi.h&gt;</code><br />
<code>#include &lt;FS.h&gt;</code><br />
<code>#include &lt;SD.h&gt;</code><br />
<code>#include &lt;preferences.h&gt;</code><br />
<code>#include &lt;<a class="el" href="lora_8h_source.html">lora.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="main_8h_source.html">main.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="temp__sens_8h_source.html">temp_sens.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="wifi__ap__serv_8h_source.html">wifi_ap_serv.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_s_d__adp_8h_source.html">SD_adp.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="air__sens_8h_source.html">air_sens.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_r_t_c___d_s3231_8h_source.html">RTC_DS3231.h</a>&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a986d1c8378e226e7d3f389c83d94d790" id="r_a986d1c8378e226e7d3f389c83d94d790"><td class="memItemLeft" align="right" valign="top">SPIClass&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a986d1c8378e226e7d3f389c83d94d790">vspi</a> (VSPI)</td></tr>
<tr class="separator:a986d1c8378e226e7d3f389c83d94d790"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d" id="r_a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="memdesc:a4fc01d736fe50cf5b977f755b675f11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup function for initializing the ESP32 and peripherals.  <br /></td></tr>
<tr class="separator:a4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f" id="r_afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="memdesc:afe461d27b9c48d5921c00d521181f12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main loop function that handles server activity and power management.  <br /></td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abef06e3b619f047a7b59887b28b33c6e" id="r_abef06e3b619f047a7b59887b28b33c6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abef06e3b619f047a7b59887b28b33c6e">logData</a> (const char *filename, const String &amp;data, bool serialout)</td></tr>
<tr class="memdesc:abef06e3b619f047a7b59887b28b33c6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Logs data to an SD card file and optionally outputs to the serial monitor.  <br /></td></tr>
<tr class="separator:abef06e3b619f047a7b59887b28b33c6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f9d0ca80f41782edf366170577a124e" id="r_a9f9d0ca80f41782edf366170577a124e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f9d0ca80f41782edf366170577a124e">handleDataLogging</a> ()</td></tr>
<tr class="memdesc:a9f9d0ca80f41782edf366170577a124e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles the data logging process.  <br /></td></tr>
<tr class="separator:a9f9d0ca80f41782edf366170577a124e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2da94e03570cd696d5e1ef31169b6f3" id="r_ae2da94e03570cd696d5e1ef31169b6f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae2da94e03570cd696d5e1ef31169b6f3">goToSleep</a> ()</td></tr>
<tr class="memdesc:ae2da94e03570cd696d5e1ef31169b6f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Puts the device into deep sleep mode.  <br /></td></tr>
<tr class="separator:ae2da94e03570cd696d5e1ef31169b6f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe87ef16aaf84b82d35566c519f789ef" id="r_abe87ef16aaf84b82d35566c519f789ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe87ef16aaf84b82d35566c519f789ef">bucket_tips</a> ()</td></tr>
<tr class="memdesc:abe87ef16aaf84b82d35566c519f789ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">counts the number of bucket tips of the rain gauge.  <br /></td></tr>
<tr class="separator:abe87ef16aaf84b82d35566c519f789ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a416b4746bdf23249a26b1d9149208f85" id="r_a416b4746bdf23249a26b1d9149208f85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a416b4746bdf23249a26b1d9149208f85">bucket_tips_log</a> ()</td></tr>
<tr class="memdesc:a416b4746bdf23249a26b1d9149208f85"><td class="mdescLeft">&#160;</td><td class="mdescRight">counts the number of bucket tips of the rain gauge.  <br /></td></tr>
<tr class="separator:a416b4746bdf23249a26b1d9149208f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addd4b4572dcd9663471534593634caac" id="r_addd4b4572dcd9663471534593634caac"><td class="memItemLeft" align="right" valign="top">void IRAM_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#addd4b4572dcd9663471534593634caac">ISR</a> ()</td></tr>
<tr class="memdesc:addd4b4572dcd9663471534593634caac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interrupt Service Routine (ISR) for handling bucket tips.  <br /></td></tr>
<tr class="separator:addd4b4572dcd9663471534593634caac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa49d929ad679cfb2cd516727c5225ef" id="r_afa49d929ad679cfb2cd516727c5225ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa49d929ad679cfb2cd516727c5225ef">check_reset_timer</a> ()</td></tr>
<tr class="separator:afa49d929ad679cfb2cd516727c5225ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3eeb80a02a2c4e1b5c56f3ab29822ba1" id="r_a3eeb80a02a2c4e1b5c56f3ab29822ba1"><td class="memItemLeft" align="right" valign="top">int RTC_DATA_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3eeb80a02a2c4e1b5c56f3ab29822ba1">num_id</a> = 0</td></tr>
<tr class="separator:a3eeb80a02a2c4e1b5c56f3ab29822ba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae789355b7f9c3fc734ba4f80938780fc" id="r_ae789355b7f9c3fc734ba4f80938780fc"><td class="memItemLeft" align="right" valign="top">int RTC_DATA_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae789355b7f9c3fc734ba4f80938780fc">bucket_tips_counter</a> = 0</td></tr>
<tr class="separator:ae789355b7f9c3fc734ba4f80938780fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af865f24a1d57da1153c934c95951b23d" id="r_af865f24a1d57da1153c934c95951b23d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af865f24a1d57da1153c934c95951b23d">bucket_tips_counter_log</a> =0</td></tr>
<tr class="separator:af865f24a1d57da1153c934c95951b23d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6d607c9a1b9a6bda0c4bb6a93c6d8ee" id="r_ad6d607c9a1b9a6bda0c4bb6a93c6d8ee"><td class="memItemLeft" align="right" valign="top">int RTC_DATA_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad6d607c9a1b9a6bda0c4bb6a93c6d8ee">sec_to_micro</a> = 1000000</td></tr>
<tr class="separator:ad6d607c9a1b9a6bda0c4bb6a93c6d8ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a447f9d5cca0f85dddba722a8efcd33bd" id="r_a447f9d5cca0f85dddba722a8efcd33bd"><td class="memItemLeft" align="right" valign="top">int RTC_DATA_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a447f9d5cca0f85dddba722a8efcd33bd">sleep_interval</a> = 60</td></tr>
<tr class="separator:a447f9d5cca0f85dddba722a8efcd33bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a385386cbe6b5277d51f6db21eaeda75e" id="r_a385386cbe6b5277d51f6db21eaeda75e"><td class="memItemLeft" align="right" valign="top">uint32_t RTC_DATA_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a385386cbe6b5277d51f6db21eaeda75e">rain_reset_timer</a> = 0</td></tr>
<tr class="separator:a385386cbe6b5277d51f6db21eaeda75e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5c6b7a0d6c3514eb8a681701bb71129" id="r_aa5c6b7a0d6c3514eb8a681701bb71129"><td class="memItemLeft" align="right" valign="top">int RTC_DATA_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5c6b7a0d6c3514eb8a681701bb71129">sleep_counter</a> = 0</td></tr>
<tr class="separator:aa5c6b7a0d6c3514eb8a681701bb71129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a763f258883ac0326002fe737204cf6" id="r_a0a763f258883ac0326002fe737204cf6"><td class="memItemLeft" align="right" valign="top">int RTC_DATA_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a763f258883ac0326002fe737204cf6">sleep_counter_limit</a> = 10</td></tr>
<tr class="separator:a0a763f258883ac0326002fe737204cf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fffef16ece2fa61dac0bc14befa5648" id="r_a6fffef16ece2fa61dac0bc14befa5648"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6fffef16ece2fa61dac0bc14befa5648">temp102</a></td></tr>
<tr class="separator:a6fffef16ece2fa61dac0bc14befa5648"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea06cf7b8092a0adaf07614d7ece59d" id="r_a6ea06cf7b8092a0adaf07614d7ece59d"><td class="memItemLeft" align="right" valign="top">Preferences&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ea06cf7b8092a0adaf07614d7ece59d">preferences</a></td></tr>
<tr class="separator:a6ea06cf7b8092a0adaf07614d7ece59d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abe87ef16aaf84b82d35566c519f789ef" name="abe87ef16aaf84b82d35566c519f789ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe87ef16aaf84b82d35566c519f789ef">&#9670;&#160;</a></span>bucket_tips()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bucket_tips </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>counts the number of bucket tips of the rain gauge. </p>
<p>this function increments the bucket_tips_counter variable by 1. </p>

</div>
</div>
<a id="a416b4746bdf23249a26b1d9149208f85" name="a416b4746bdf23249a26b1d9149208f85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a416b4746bdf23249a26b1d9149208f85">&#9670;&#160;</a></span>bucket_tips_log()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bucket_tips_log </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>counts the number of bucket tips of the rain gauge. </p>
<p>this function increments the bucket_tips_counter variable by 1. </p>

</div>
</div>
<a id="afa49d929ad679cfb2cd516727c5225ef" name="afa49d929ad679cfb2cd516727c5225ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa49d929ad679cfb2cd516727c5225ef">&#9670;&#160;</a></span>check_reset_timer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_reset_timer </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae2da94e03570cd696d5e1ef31169b6f3" name="ae2da94e03570cd696d5e1ef31169b6f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2da94e03570cd696d5e1ef31169b6f3">&#9670;&#160;</a></span>goToSleep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void goToSleep </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Puts the device into deep sleep mode. </p>
<p>This function performs the necessary steps to put the device into deep sleep mode. It turns off the Wi-Fi to save power, stops the Wi-Fi driver, and starts the deep sleep mode. </p>

</div>
</div>
<a id="a9f9d0ca80f41782edf366170577a124e" name="a9f9d0ca80f41782edf366170577a124e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f9d0ca80f41782edf366170577a124e">&#9670;&#160;</a></span>handleDataLogging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void handleDataLogging </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles the data logging process. </p>
<p>This function is responsible for logging data when the system wakes up. Retrieves the current date and time from the RTC, formats the date and time, and logs the datam to a specified file.</p>
<p>The logged data includes thetemperatur,the amount of rain, the current date, time, and a numerical identifier. </p>

</div>
</div>
<a id="addd4b4572dcd9663471534593634caac" name="addd4b4572dcd9663471534593634caac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addd4b4572dcd9663471534593634caac">&#9670;&#160;</a></span>ISR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IRAM_ATTR ISR </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interrupt Service Routine (ISR) for handling bucket tips. </p>
<p>This function is marked with IRAM_ATTR to ensure it is placed in the IRAM (Instruction RAM) for faster execution. It is triggered by an interrupt and calls the <a class="el" href="#a416b4746bdf23249a26b1d9149208f85" title="counts the number of bucket tips of the rain gauge.">bucket_tips_log()</a> function to log the bucket tips. </p>

</div>
</div>
<a id="abef06e3b619f047a7b59887b28b33c6e" name="abef06e3b619f047a7b59887b28b33c6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abef06e3b619f047a7b59887b28b33c6e">&#9670;&#160;</a></span>logData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void logData </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const String &amp;</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>serialout</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Logs data to an SD card file and optionally outputs to the serial monitor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The name of the file to write to on the SD card. </td></tr>
    <tr><td class="paramname">data</td><td>The data to be written to the file. </td></tr>
    <tr><td class="paramname">serialout</td><td>If true, outputs status messages to the serial monitor. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afe461d27b9c48d5921c00d521181f12f" name="afe461d27b9c48d5921c00d521181f12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe461d27b9c48d5921c00d521181f12f">&#9670;&#160;</a></span>loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loop </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main loop function that handles server activity and power management. </p>
<p>This function continuously checks the status of the server and manages power consumption. If the server is active, it checks for a timeout or a wakeup pin press to stop the server and put the device to sleep. If the server is not active, it puts the device to sleep immediately. </p>

</div>
</div>
<a id="a4fc01d736fe50cf5b977f755b675f11d" name="a4fc01d736fe50cf5b977f755b675f11d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fc01d736fe50cf5b977f755b675f11d">&#9670;&#160;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup function for initializing the ESP32 and peripherals. </p>
<p>This function performs the following tasks:</p><ul>
<li>Initializes the I2C communication on specified pins.</li>
<li>Disables Bluetooth and WiFi to save power.</li>
<li>Initializes the Serial communication for debugging purposes.</li>
<li>Sets the CPU to 80MHz.</li>
<li>Configures wakeup sources for deep sleep.</li>
<li>Checks the wakeup reason and handles accordingly:<ul>
<li>If woken up by GPIO pin, checks which pin caused the wakeup and handles sensor or WiFi server.</li>
<li>If woken up by timer, initializes RTC, BME280 sensor, and SD card, then logs data.</li>
<li>If initial boot or not a GPIO wakeup, scans I2C devices and initializes RTC and CCS811 sensor.</li>
</ul>
</li>
<li>Initializes preferences to store and retrieve data.</li>
<li>Logs wakeup reason and other debug information to Serial (to be removed in final version). </li>
</ul>

</div>
</div>
<a id="a986d1c8378e226e7d3f389c83d94d790" name="a986d1c8378e226e7d3f389c83d94d790"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a986d1c8378e226e7d3f389c83d94d790">&#9670;&#160;</a></span>vspi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SPIClass vspi </td>
          <td>(</td>
          <td class="paramtype">VSPI</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ae789355b7f9c3fc734ba4f80938780fc" name="ae789355b7f9c3fc734ba4f80938780fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae789355b7f9c3fc734ba4f80938780fc">&#9670;&#160;</a></span>bucket_tips_counter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RTC_DATA_ATTR bucket_tips_counter = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af865f24a1d57da1153c934c95951b23d" name="af865f24a1d57da1153c934c95951b23d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af865f24a1d57da1153c934c95951b23d">&#9670;&#160;</a></span>bucket_tips_counter_log</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int bucket_tips_counter_log =0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3eeb80a02a2c4e1b5c56f3ab29822ba1" name="a3eeb80a02a2c4e1b5c56f3ab29822ba1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eeb80a02a2c4e1b5c56f3ab29822ba1">&#9670;&#160;</a></span>num_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RTC_DATA_ATTR num_id = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6ea06cf7b8092a0adaf07614d7ece59d" name="a6ea06cf7b8092a0adaf07614d7ece59d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ea06cf7b8092a0adaf07614d7ece59d">&#9670;&#160;</a></span>preferences</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Preferences preferences</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a385386cbe6b5277d51f6db21eaeda75e" name="a385386cbe6b5277d51f6db21eaeda75e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a385386cbe6b5277d51f6db21eaeda75e">&#9670;&#160;</a></span>rain_reset_timer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t RTC_DATA_ATTR rain_reset_timer = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad6d607c9a1b9a6bda0c4bb6a93c6d8ee" name="ad6d607c9a1b9a6bda0c4bb6a93c6d8ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6d607c9a1b9a6bda0c4bb6a93c6d8ee">&#9670;&#160;</a></span>sec_to_micro</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RTC_DATA_ATTR sec_to_micro = 1000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa5c6b7a0d6c3514eb8a681701bb71129" name="aa5c6b7a0d6c3514eb8a681701bb71129"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5c6b7a0d6c3514eb8a681701bb71129">&#9670;&#160;</a></span>sleep_counter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RTC_DATA_ATTR sleep_counter = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0a763f258883ac0326002fe737204cf6" name="a0a763f258883ac0326002fe737204cf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a763f258883ac0326002fe737204cf6">&#9670;&#160;</a></span>sleep_counter_limit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RTC_DATA_ATTR sleep_counter_limit = 10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a447f9d5cca0f85dddba722a8efcd33bd" name="a447f9d5cca0f85dddba722a8efcd33bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a447f9d5cca0f85dddba722a8efcd33bd">&#9670;&#160;</a></span>sleep_interval</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RTC_DATA_ATTR sleep_interval = 60</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6fffef16ece2fa61dac0bc14befa5648" name="a6fffef16ece2fa61dac0bc14befa5648"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fffef16ece2fa61dac0bc14befa5648">&#9670;&#160;</a></span>temp102</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float temp102</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="main_8cpp.html">main.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
